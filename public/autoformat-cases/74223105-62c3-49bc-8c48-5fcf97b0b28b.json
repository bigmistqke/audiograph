{
  "id": "74223105-62c3-49bc-8c48-5fcf97b0b28b",
  "title": "Top-alignment accepted even when it produces a long diagonal edge",
  "comments": [
    {
      "role": "user",
      "text": "we prefer top-alignment currently, although in this case it does create a long diagonal edge, which is something we in general try to avoid"
    },
    {
      "role": "assistant",
      "text": "Two paths from A to D (merge): top path A→B→C→D (3 nodes) and bottom path A→E→D (1 node).\n\nForward pass: D.x = max(C.right, E.right) + gap = max(360, 230) + 30 = 390 — driven entirely by the longer top chain. E goes to row 1 (y=110) because it can't fit alongside [A,B,C,D] in row 0.\n\nThe E→D edge spans x=230 to x=390 across two rows — a long diagonal. The algorithm accepts this as a trade-off of preferring top-alignment.\n\nRule tested: forward pass places merge at the longest incoming chain; top-alignment preference can produce long cross-row diagonal edges."
    },
    {
      "role": "user",
      "text": "E is not pulled towards D -> the pull of split-child (A-E) is stronger then the pull of parent-merge (E-D)"
    }
  ],
  "initial": {
    "nodes": {
      "A": {
        "id": "A",
        "type": "node",
        "x": 0,
        "y": 0,
        "dimensions": {
          "x": 100,
          "y": 80
        }
      },
      "B": {
        "id": "B",
        "type": "node",
        "x": 150,
        "y": -30,
        "dimensions": {
          "x": 100,
          "y": 80
        }
      },
      "C": {
        "id": "C",
        "type": "node",
        "x": 300,
        "y": -10,
        "dimensions": {
          "x": 100,
          "y": 80
        }
      },
      "D": {
        "id": "D",
        "type": "node",
        "x": 430,
        "y": 100,
        "dimensions": {
          "x": 100,
          "y": 80
        }
      },
      "E": {
        "id": "E",
        "type": "node",
        "x": 220,
        "y": 200,
        "dimensions": {
          "x": 100,
          "y": 80
        }
      }
    },
    "edges": [
      {
        "output": {
          "node": "A",
          "port": "out"
        },
        "input": {
          "node": "E",
          "port": "in"
        }
      },
      {
        "output": {
          "node": "A",
          "port": "out"
        },
        "input": {
          "node": "B",
          "port": "in"
        }
      },
      {
        "output": {
          "node": "B",
          "port": "out"
        },
        "input": {
          "node": "C",
          "port": "in"
        }
      },
      {
        "output": {
          "node": "C",
          "port": "out"
        },
        "input": {
          "node": "D",
          "port": "in"
        }
      },
      {
        "output": {
          "node": "E",
          "port": "out"
        },
        "input": {
          "node": "D",
          "port": "in"
        }
      }
    ]
  },
  "expected": {
    "nodes": {
      "A": {
        "id": "A",
        "type": "node",
        "x": 0,
        "y": 0,
        "dimensions": {
          "x": 100,
          "y": 80
        }
      },
      "B": {
        "id": "B",
        "type": "node",
        "x": 130,
        "y": 0,
        "dimensions": {
          "x": 100,
          "y": 80
        }
      },
      "C": {
        "id": "C",
        "type": "node",
        "x": 260,
        "y": 0,
        "dimensions": {
          "x": 100,
          "y": 80
        }
      },
      "D": {
        "id": "D",
        "type": "node",
        "x": 390,
        "y": 0,
        "dimensions": {
          "x": 100,
          "y": 80
        }
      },
      "E": {
        "id": "E",
        "type": "node",
        "x": 130,
        "y": 110,
        "dimensions": {
          "x": 100,
          "y": 80
        }
      }
    },
    "edges": [
      {
        "output": {
          "node": "A",
          "port": "out"
        },
        "input": {
          "node": "B",
          "port": "in"
        }
      },
      {
        "output": {
          "node": "B",
          "port": "out"
        },
        "input": {
          "node": "C",
          "port": "in"
        }
      },
      {
        "output": {
          "node": "C",
          "port": "out"
        },
        "input": {
          "node": "D",
          "port": "in"
        }
      },
      {
        "output": {
          "node": "A",
          "port": "out"
        },
        "input": {
          "node": "E",
          "port": "in"
        }
      },
      {
        "output": {
          "node": "E",
          "port": "out"
        },
        "input": {
          "node": "D",
          "port": "in"
        }
      }
    ]
  }
}
